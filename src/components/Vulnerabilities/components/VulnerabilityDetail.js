import React from 'react';
import ReactHtmlParser from "react-html-parser";
import RatingImage from "../../common/RatingImage";
import {arraySeparator} from "../../../helpers";

const VulnerabilityDetail = ({detail}) => {
    return (
        <div className="modal-body vul_modal_inner_padding">
            <div className="container">
                <h4>Vulnerability</h4>
                <hr />
                <p>{detail.title}</p>
                <label htmlFor="CVEID">CVE ID :</label> <span>{detail.cve_id}</span>
                <div className="clearfix" />
                <label htmlFor="CVSSScore">CVSS Score:</label> <span>{detail.cvss}</span>
                <div className="clearfix" />
                <label htmlFor="Description">Description:</label>
                {ReactHtmlParser(detail.description)}
                <label htmlFor="Severity">Severity:</label>
                <p><RatingImage rating={detail.severity} /></p>
                <label htmlFor="LossType">Loss Type:</label>
                <p>Confidentiality {detail.ltc ? 'TRUE' : 'FALSE'} <br />
                    Integrity {detail.lti ? 'TRUE' : 'FALSE'}<br />
                    Availability {detail.lta ? 'TRUE' : 'FALSE'}</p>
                <label htmlFor="VulnerabilityType">Vulnerability Type : </label>
                <span> {detail.type?.name ?? "none"}</span>
                <div className="clearfix" />
                <label htmlFor="Link">Link : </label>
                <span><a href={detail.links} target="_blank" className="thrat_intel_green_modal">{detail.links}</a></span>
                <div className="clearfix" />

                <label htmlFor="ProductAffected">Product Affected : </label>
                <span>{arraySeparator(detail.product)}</span>
                {/*{detail.product.length > 0 ? detail.product?.map((res, index) => {*/}
                {/*    return <span key={index}>res.name</span>;*/}
                {/*}): <span>None</span>}*/}
                <div className="clearfix" />
                <label htmlFor="Risk">Risk : </label>
                <span>{detail.risk?.toUpperCase()}</span>
                <div className="clearfix" />
                <label htmlFor="Platform">Platform : </label>
                <span>{arraySeparator(detail.platform)}</span>
                {/*{detail.platform.length > 0 ? detail.platform?.map((res, index) => {*/}
                {/*    return <span key={index}>res.name {index !== detail.platform.length - 1 ? ', ' : ''}</span> ;*/}
                {/*}): <span>None</span>}*/}
                <div className="clearfix" />
                <label htmlFor="UserInteraction">User Interaction : </label>
                <span>{detail.user_interaction?.toUpperCase()}</span>
            </div>
        </div>
    );
};

export default VulnerabilityDetail;